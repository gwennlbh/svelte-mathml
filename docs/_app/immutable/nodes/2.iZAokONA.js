import"../chunks/DsnmJJEf.js";import"../chunks/B3nImBrM.js";import{s as re,a as he}from"../chunks/D6ML1fVz.js";import{a7 as le,p as f,q as i,v as t,aa as oe,aR as j,ab as Q,ac as R,a9 as ne,ad as C,r as A,aQ as ge,O as g,aP as ee,a8 as pe}from"../chunks/D2vyAq4L.js";import{i as v,p as be,s as we}from"../chunks/D9Wgt_w9.js";var ye=j("<mn> </mn>"),ke=j("<mi> </mi>");function F(P,e){le(e,!0);var b=f(),w=i(b);{var W=c=>{var _=ye(),y=Q(_,!0);R(_),ne(()=>re(y,e.expr)),t(c,_)},L=c=>{var _=ke(),y=Q(_,!0);R(_),ne(()=>re(y,e.expr)),t(c,_)};v(w,c=>{/^\d+$/.test(e.expr)?c(W):c(L,!1)})}t(P,b),oe()}var De=j("<mfrac><!> <!></mfrac>");function Pe(P,e){var b=De(),w=Q(b);{var W=d=>{F(d,{get expr(){return e.numerator}})},L=d=>{var q=f(),a=i(q);A(a,()=>e.numerator),t(d,q)};v(w,d=>{typeof e.numerator=="string"?d(W):d(L,!1)})}var c=C(w,2);{var _=d=>{F(d,{get expr(){return e.denominator}})},y=d=>{var q=f(),a=i(q);A(a,()=>e.denominator),t(d,q)};v(c,d=>{typeof e.denominator=="string"?d(_):d(y,!1)})}R(b),t(P,b)}var We=j("<mrow><!></mrow>");function Oe(P,e){var b=We(),w=Q(b);A(w,()=>e.children),R(b),t(P,b)}var Se=j("<mo><!></mo>"),Ae=j("<!> <!> <!>",1);function Le(P,e){var b=Ae(),w=i(b);{var W=a=>{F(a,{get expr(){return e.lhs}})},L=a=>{var n=f(),m=i(n);A(m,()=>e.lhs),t(a,n)};v(w,a=>{typeof e.lhs=="string"?a(W):a(L,!1)})}var c=C(w,2);{var _=a=>{var n=Se(),m=Q(n);{var h=o=>{var r=ge("Â·");t(o,r)},p=o=>{var r=ge();ne(()=>re(r,e.operator)),t(o,r)};v(m,o=>{e.operator==="*"?o(h):o(p,!1)})}R(n),t(a,n)};v(c,a=>{e.operator&&a(_)})}var y=C(c,2);{var d=a=>{F(a,{get expr(){return e.rhs}})},q=a=>{var n=f(),m=i(n);A(m,()=>e.rhs),t(a,n)};v(y,a=>{typeof e.rhs=="string"?a(d):a(q,!1)})}t(P,b)}var qe=j("<msubsup><!> <!> <!></msubsup>"),Ee=j("<msup><!> <!></msup>"),Fe=j("<msub><!> <!></msub>");function ue(P,e){var b=f(),w=i(b);{var W=c=>{var _=qe(),y=Q(_);{var d=r=>{var l=f(),s=i(l);A(s,()=>e.children),t(r,l)},q=r=>{var l=f(),s=i(l);{var u=x=>{F(x,{get expr(){return e.base}})};v(s,x=>{e.base&&x(u)},!0)}t(r,l)};v(y,r=>{e.children?r(d):r(q,!1)})}var a=C(y,2);{var n=r=>{F(r,{get expr(){return e.sub}})},m=r=>{var l=f(),s=i(l);A(s,()=>e.sub),t(r,l)};v(a,r=>{typeof e.sub=="string"?r(n):r(m,!1)})}var h=C(a,2);{var p=r=>{F(r,{get expr(){return e.sup}})},o=r=>{var l=f(),s=i(l);A(s,()=>e.sup),t(r,l)};v(h,r=>{typeof e.sup=="string"?r(p):r(o,!1)})}R(_),t(c,_)},L=c=>{var _=f(),y=i(_);{var d=a=>{var n=Ee(),m=Q(n);{var h=s=>{var u=f(),x=i(u);A(x,()=>e.children),t(s,u)},p=s=>{var u=f(),x=i(u);{var D=M=>{F(M,{get expr(){return e.base}})};v(x,M=>{e.base&&M(D)},!0)}t(s,u)};v(m,s=>{e.children?s(h):s(p,!1)})}var o=C(m,2);{var r=s=>{F(s,{get expr(){return e.sup}})},l=s=>{var u=f(),x=i(u);A(x,()=>e.sup),t(s,u)};v(o,s=>{typeof e.sup=="string"?s(r):s(l,!1)})}R(n),t(a,n)},q=a=>{var n=f(),m=i(n);{var h=o=>{var r=Fe(),l=Q(r);{var s=k=>{var O=f(),J=i(O);A(J,()=>e.children),t(k,O)},u=k=>{var O=f(),J=i(O);{var G=H=>{F(H,{get expr(){return e.base}})};v(J,H=>{e.base&&H(G)},!0)}t(k,O)};v(l,k=>{e.children?k(s):k(u,!1)})}var x=C(l,2);{var D=k=>{F(k,{get expr(){return e.sub}})},M=k=>{var O=f(),J=i(O);A(J,()=>e.sub),t(k,O)};v(x,k=>{typeof e.sub=="string"?k(D):k(M,!1)})}R(r),t(o,r)},p=o=>{var r=f(),l=i(r);{var s=x=>{var D=f(),M=i(D);A(M,()=>e.children),t(x,D)},u=x=>{var D=f(),M=i(D);{var k=O=>{F(O,{get expr(){return e.base}})};v(M,O=>{e.base&&O(k)},!0)}t(x,D)};v(l,x=>{e.children?x(s):x(u,!1)},!0)}t(o,r)};v(m,o=>{e.sub?o(h):o(p,!1)},!0)}t(a,n)};v(y,a=>{e.sup?a(d):a(q,!1)},!0)}t(c,_)};v(w,c=>{e.sub&&e.sup?c(W):c(L,!1)})}t(P,b)}var Me=j('<mrow><mo fence="true" form="prefix"> </mo> <!> <mo fence="true" form="postfix"> </mo></mrow>');function Qe(P,e){le(e,!0);const b=be(e,"with",3,"()");var w=Me(),W=Q(w),L=Q(W,!0);R(W);var c=C(W,2);A(c,()=>e.children);var _=C(c,2),y=Q(_,!0);R(_),R(w),ne(()=>{re(L,b()[0]),re(y,b()[1])}),t(P,w),oe()}var Re=j("<math><!></math>");function S(P,e){le(e,!0);const b=be(e,"bare",3,!1),w=/^([\p{Letter}0-9]+)$/u;function W(n,m,h){return n.startsWith(m)&&n.endsWith(h)}const L=ee(()=>e.expr?W(e.expr,"(",")")?{with:"()",content:e.expr.slice(1,-1)}:W(e.expr,"[","]")?{with:"[]",content:e.expr.slice(1,-1)}:W(e.expr,"{","}")?{with:"{}",content:e.expr.slice(1,-1)}:null:null),c=ee(()=>{if(!e.expr)return null;if(!e.expr.includes("_")&&!e.expr.includes("^"))return{base:e.expr,subscript:"",superscript:""};let n="",m="",h="",p=0,o=0,r=0,l=!1,s=!1;for(const u of e.expr){if(u==="}"?o--:u==="{"?o++:u==="]"?r--:u==="["?r++:u===")"?p--:u==="("&&p++,o<0||r<0||p<0)break;if(o===0&&r===0&&p===0){if(u==="_"){l=!0,s=!1;continue}else if(u==="^"){s=!0,l=!1;continue}}l?m+=u:s?h+=u:n+=u}return{base:n,subscript:m,superscript:h}}),_=ee(()=>{if(!e.expr)return null;const n=["+","-","*","/","="];if(!n.some(r=>e.expr.includes(r)))return null;let m=0,h=0,p=0,o=-1;for(const r of e.expr){if(o++,r==="}"?h--:r==="{"?h++:r==="]"?p--:r==="["?p++:r===")"?m--:r==="("&&m++,h<0||p<0||m<0)break;if(h===0&&p===0&&m===0&&n.includes(r))return{left:e.expr.slice(0,o).trim(),operator:r,right:e.expr.slice(o+1).trim()}}return null});var y=f(),d=i(y);{var q=n=>{},a=n=>{var m=f(),h=i(m);{var p=r=>{var l=Re(),s=Q(l);Oe(s,{children:(u,x)=>{S(u,{bare:!0,get expr(){return e.expr}})}}),R(l),t(r,l)},o=r=>{var l=f(),s=i(l);{var u=D=>{F(D,{get expr(){return e.expr}})},x=D=>{var M=f(),k=i(M);{var O=G=>{Qe(G,we(()=>g(L),{children:(H,me)=>{S(H,{bare:!0,get expr(){return g(L).content}})},$$slots:{default:!0}}))},J=G=>{var H=f(),me=i(H);{var de=N=>{const z=ee(()=>{const{left:T,operator:X,right:Y}=g(_);return{left:T,operator:X,right:Y}});var te=f(),se=i(te);{var V=T=>{Pe(T,{numerator:B=>{S(B,{bare:!0,get expr(){return g(z).left}})},denominator:B=>{S(B,{bare:!0,get expr(){return g(z).right}})}})},E=T=>{Le(T,{get operator(){return g(z).operator},lhs:B=>{S(B,{bare:!0,get expr(){return g(z).left}})},rhs:B=>{S(B,{bare:!0,get expr(){return g(z).right}})}})};v(se,T=>{g(z).operator==="/"?T(V):T(E,!1)})}t(N,te)},xe=N=>{var z=f(),te=i(z);{var se=V=>{const E=ee(()=>{const{base:I,subscript:Z,superscript:ae}=g(c);return{base:I,subscript:Z,superscript:ae}});var T=f(),X=i(T);{var Y=I=>{ue(I,{sub:K=>{S(K,{bare:!0,get expr(){return g(E).subscript}})},sup:K=>{S(K,{bare:!0,get expr(){return g(E).superscript}})},children:(K,ce)=>{S(K,{bare:!0,get expr(){return g(E).base}})}})},B=I=>{var Z=f(),ae=i(Z);{var K=U=>{ue(U,{sup:$=>{S($,{bare:!0,get expr(){return g(E).superscript}})},children:($,_e)=>{S($,{bare:!0,get expr(){return g(E).base}})}})},ce=U=>{var ie=f(),$=i(ie);{var _e=ve=>{ue(ve,{sub:fe=>{S(fe,{bare:!0,get expr(){return g(E).subscript}})},children:(fe,ze)=>{S(fe,{bare:!0,get expr(){return g(E).base}})}})};v($,ve=>{g(E).subscript&&ve(_e)},!0)}t(U,ie)};v(ae,U=>{g(E).superscript?U(K):U(ce,!1)},!0)}t(I,Z)};v(X,I=>{g(E).superscript&&g(E).subscript?I(Y):I(B,!1)})}t(V,T)};v(te,V=>{g(c)&&V(se)},!0)}t(N,z)};v(me,N=>{g(_)?N(de):N(xe,!1)},!0)}t(G,H)};v(k,G=>{g(L)?G(O):G(J,!1)},!0)}t(D,M)};v(s,D=>{w.test(e.expr)?D(u):D(x,!1)},!0)}t(r,l)};v(h,r=>{b()?r(o,!1):r(p)},!0)}t(n,m)};v(d,n=>{e.expr?n(a,!1):n(q)})}t(P,y),oe()}var Te=pe('<link rel="stylesheet" href="/svelte-mathml/import.css"/>');function Je(P){he(e=>{var b=Te();t(e,b)}),S(P,{expr:"2*e_x+(e_y-w/2)"})}export{Je as component};
